
# Tunora - AI éŸ³ä¹åˆ›ä½œåˆ†äº«ç¤¾åŒº

> **Independent tool for AI music creators. Not affiliated with Suno.ai**

[![React](https://img.shields.io/badge/React-18.0-blue?logo=react)](https://react.dev/)
[![Vite](https://img.shields.io/badge/Vite-5.0-purple?logo=vite)](https://vitejs.dev/)
[![Tailwind CSS](https://img.shields.io/badge/Tailwind-3.4-38b2ac?logo=tailwind-css)](https://tailwindcss.com/)
[![Supabase](https://img.shields.io/badge/Supabase-Database-green?logo=supabase)](https://supabase.com/)

Tunora æ˜¯ä¸€ä¸ªä¸“ä¸º AI éŸ³ä¹åˆ›ä½œè€…æ‰“é€ çš„å¢å¼ºå·¥å…·å¹³å°ã€‚å®ƒä¸ä»…è§£å†³äº† Suno å®˜æ–¹é“¾æ¥åˆ†äº«å½¢å¼å•ä¸€çš„é—®é¢˜ï¼Œè¿˜æä¾›äº†æ­Œè¯åŒæ­¥æ˜¾ç¤ºã€ç¤¾äº¤äº’åŠ¨ã€æ’è¡Œæ¦œä»¥åŠæ°¸ä¹…äº‘ç«¯å¤‡ä»½åŠŸèƒ½ã€‚

---

## ğŸ’» æ¨èå¼€å‘ç¯å¢ƒ

**æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ React + Vite åº”ç”¨ï¼Œå®Œå…¨è„±ç¦» Google AI Studio é™åˆ¶ã€‚**

ä¸ºäº†è·å¾—æœ€ä½³çš„å…è´¹å¼€å‘ä½“éªŒï¼Œé¿å…ç¯å¢ƒå…¼å®¹æ€§é—®é¢˜ï¼Œæˆ‘ä»¬å¼ºçƒˆæ¨èä½¿ç”¨ä»¥ä¸‹æ–¹æ¡ˆï¼š

### 1. GitHub Codespaces (é¦–é€‰æ¨è ğŸŒŸ)
- **å®Œå…¨äº‘ç«¯**: æ— éœ€æœ¬åœ°é…ç½®ï¼Œç›´æ¥åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨å®Œæ•´çš„ VS Codeã€‚
- **ç¯å¢ƒçº¯å‡€**: æ ‡å‡†çš„ Docker å®¹å™¨ç¯å¢ƒï¼Œå®Œç¾æ”¯æŒ `npm install` å’Œ `dev` é¢„è§ˆã€‚
- **å…è´¹é¢åº¦**: ä¸ªäººç”¨æˆ·æ¯æœˆæ‹¥æœ‰ 60 å°æ—¶å…è´¹ä½¿ç”¨æ—¶é—´ï¼Œè¶³å¤Ÿæ—¥å¸¸å¼€å‘ã€‚
- **ä½¿ç”¨æ–¹æ³•**: ç‚¹å‡»æœ¬ä»“åº“å³ä¸Šè§’çš„ç»¿è‰² `<> Code` æŒ‰é’® -> é€‰æ‹© **Codespaces** -> **Create codespace on main**ã€‚

### 2. æœ¬åœ° VS Code (æœ€ç¨³å¥)
- å¦‚æœæ‚¨æœ‰ç”µè„‘ï¼Œç›´æ¥ Git Clone åˆ°æœ¬åœ°å¼€å‘æ˜¯æœ€ç¨³å¦¥çš„ã€‚

---

## ğŸš€ éƒ¨ç½²åˆ° Vercel (ä¿å§†çº§æ•™ç¨‹)

è¦æƒ³è®©æœ‹å‹è®¿é—®æ‚¨çš„ Appï¼Œæ‚¨å¿…é¡»å°†å…¶éƒ¨ç½²åˆ°å…¬ç½‘ã€‚Vercel æ˜¯ç›®å‰æœ€æ¨èã€å…è´¹ä¸”é€Ÿåº¦æå¿«çš„æ‰˜ç®¡å¹³å°ã€‚

### ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡ä»£ç 
1. ç¡®ä¿æ‚¨çš„ä»£ç å·²ç»æäº¤ï¼ˆCommitï¼‰å¹¶æ¨é€åˆ° **GitHub** ä»“åº“ã€‚
   - å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯äº‘ç«¯ IDEï¼ˆå¦‚ Project IDX, StackBlitzï¼‰ï¼Œé€šå¸¸ä¾§è¾¹æ ä¼šæœ‰ "Source Control" æŒ‰é’®ï¼Œç‚¹å‡» "Publish to GitHub"ã€‚

### ç¬¬äºŒæ­¥ï¼šåœ¨ Vercel å¯¼å…¥é¡¹ç›®
1. æ³¨å†Œå¹¶ç™»å½• [Vercel.com](https://vercel.com)ã€‚
2. åœ¨ Dashboard ç‚¹å‡»é»‘è‰²çš„ **"Add New..."** æŒ‰é’®ï¼Œé€‰æ‹© **"Project"**ã€‚
3. åœ¨å·¦ä¾§ "Import Git Repository" åˆ—è¡¨ä¸­ï¼Œæ‰¾åˆ°æ‚¨çš„ `Tunora` ä»“åº“ï¼Œç‚¹å‡» **"Import"**ã€‚

### ç¬¬ä¸‰æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡ (â­â­â­ æœ€å…³é”®ä¸€æ­¥)
åœ¨å¯¼å…¥é¡µé¢çš„ **"Environment Variables"** (ç¯å¢ƒå˜é‡) åŒºåŸŸï¼Œæ‚¨å¿…é¡»å¡«å…¥ Supabase çš„è¿æ¥ä¿¡æ¯ï¼Œå¦åˆ™ç½‘ç«™éƒ¨ç½²åæ— æ³•åŠ è½½æ•°æ®ã€‚

ç‚¹å‡»å±•å¼€è¯¥åŒºåŸŸï¼Œæ·»åŠ ä»¥ä¸‹ä¸¤ä¸ªå˜é‡ï¼ˆä»æ‚¨çš„ Supabase é¡¹ç›®è®¾ç½® -> API ä¸­è·å–ï¼‰ï¼š

| Name (é”®) | Value (å€¼) |
| :--- | :--- |
| `VITE_SUPABASE_URL` | `æ‚¨çš„ Supabase Project URL` (ä¾‹å¦‚ https://xyz.supabase.co) |
| `VITE_SUPABASE_ANON_KEY` | `æ‚¨çš„ Supabase Anon Key` (ä»¥ eyJ å¼€å¤´çš„é•¿å­—ç¬¦ä¸²) |

### ç¬¬å››æ­¥ï¼šç‚¹å‡»éƒ¨ç½²
1. æ£€æŸ¥ Framework Preset æ˜¯å¦è‡ªåŠ¨è¯†åˆ«ä¸º **Vite** (é€šå¸¸ä¼šè‡ªåŠ¨è¯†åˆ«)ã€‚
2. ç‚¹å‡»è“è‰²çš„ **"Deploy"** æŒ‰é’®ã€‚
3. ç­‰å¾…çº¦ 1 åˆ†é’Ÿï¼ŒVercel ä¼šè‡ªåŠ¨æ„å»ºã€æ‰“åŒ…å¹¶å‘å¸ƒã€‚
4. å®Œæˆåï¼Œæ‚¨ä¼šçœ‹åˆ°æ»¡å±çš„æ’’èŠ±ç‰¹æ•ˆã€‚ç‚¹å‡» **"Visit"** å³å¯è·å¾—æ‚¨çš„ä¸“å±æ°¸ä¹…åŸŸåï¼ˆä¾‹å¦‚ `https://tunora-yourname.vercel.app`ï¼‰ã€‚

ğŸ‰ **ç°åœ¨ï¼ŒæŠŠè¿™ä¸ªé“¾æ¥åˆ†äº«ç»™æœ‹å‹ï¼Œä»–ä»¬å°±èƒ½å®Œç¾æ‰“å¼€äº†ï¼**

---

## â“ å¸¸è§é—®é¢˜æ’æŸ¥ (Troubleshooting)

### Q: éƒ¨ç½²åæ‰“å¼€ç½‘ç«™æ˜¯ä¸€ç‰‡ç©ºç™½ï¼Ÿ
A: è¿™æ˜¯å› ä¸º `index.html` ä¸­å¯èƒ½æ®‹ç•™äº† `importmap` ä»£ç ï¼Œå¯¼è‡´ä¸ Vite æ‰“åŒ…æ–‡ä»¶å†²çªã€‚
**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æœ¬ä»£ç åº“å·²ä¿®å¤æ­¤é—®é¢˜ï¼Œç§»é™¤äº† `index.html` ä¸­çš„ `<script type="importmap">...</script>`ã€‚
2. è¯·ç¡®ä¿æ‚¨å·²æ‹‰å–æœ€æ–°ä»£ç å¹¶æ¨é€åˆ° GitHubã€‚
3. Vercel ä¼šè‡ªåŠ¨é‡æ–°éƒ¨ç½²ï¼Œé—®é¢˜å³å¯è§£å†³ã€‚

### Q: åˆ·æ–°é¡µé¢å‡ºç° 404ï¼Ÿ
A: è¯·æ£€æŸ¥é¡¹ç›®æ ¹ç›®å½•æ˜¯å¦æœ‰ `vercel.json` æ–‡ä»¶ï¼Œå¹¶åŒ…å« rewrite é…ç½®ã€‚æœ¬ä»“åº“å·²åŒ…å«æ ‡å‡†é…ç½®ã€‚

---

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ§ æ²‰æµ¸å¼æ’­æ”¾ä½“éªŒ
- **æ— é™å…¨å±€æ¼«æ¸¸**: å³ä½¿æ²¡æœ‰æ·»åŠ åˆ°æ’­æ”¾åˆ—è¡¨ï¼Œç³»ç»Ÿä¹Ÿèƒ½æ™ºèƒ½æ’­æ”¾å…¨ç«™æ­Œæ›²ã€‚ç‚¹å‡»â€œä¸Šä¸€é¦–/ä¸‹ä¸€é¦–â€ä¼šè‡ªåŠ¨åœ¨æ•°æ®åº“ä¸­å¯»æ‰¾ç›¸é‚»æ­Œæ›²ï¼Œå¹¶åœ¨æœ€æ–°ä¸æœ€æ—§æ­Œæ›²ä¹‹é—´è‡ªåŠ¨é¦–å°¾ç›¸è¿ï¼Œå®ç°æ°¸ä¸åœæ­‡çš„éŸ³ä¹æµã€‚
- **æ™ºèƒ½æ­Œè¯åŒæ­¥ (Sync V2)**: è‡ªåŠ¨è¯†åˆ« Verse/Chorus ç»“æ„ï¼Œæ™ºèƒ½è·³è¿‡éæ­Œè¯æ ‡ç­¾ï¼Œå®ç°ç²¾å‡†çš„å¡æ‹‰OKå¼æ»šåŠ¨ä½“éªŒã€‚
- **ç§»åŠ¨ç«¯ä¼˜åŒ–**: ä¸“ä¸ºæ‰‹æœºè®¾è®¡çš„å…¨å±å¾…æ’­æ¸…å•ï¼Œéšæ—¶éšåœ°è½»æ¾ç®¡ç†æ’­æ”¾é˜Ÿåˆ—ã€‚
- **é«˜çº§æ’­æ”¾æ§åˆ¶**: æ”¯æŒå•æ›²å¾ªç¯ã€åˆ—è¡¨å¾ªç¯ã€éšæœºæ’­æ”¾ä»¥åŠç‹¬åˆ›çš„â€œåŒæ¬¡å¾ªç¯â€æ¨¡å¼ã€‚
- **è‡ªæ„ˆå¼éŸ³é¢‘æ’­æ”¾å™¨**: å¦‚æœ Supabase äº‘ç«¯å¤‡ä»½éŸ³é¢‘å¤±æ•ˆï¼ˆ404/403ï¼‰ï¼Œæ’­æ”¾å™¨ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶æ— ç¼åˆ‡æ¢å› Suno å®˜æ–¹æºï¼Œç¡®ä¿æŒç»­å¯å¬ã€‚
- **å¾…æ’­æ¸…å•**: ä¾§è¾¹æ ç®¡ç†æ’­æ”¾é˜Ÿåˆ—ï¼Œæ”¯æŒä¸€é”®æ¸…ç©ºå’Œéšæœºæ‰“ä¹±ã€‚

### ğŸ› ï¸ å¼ºå¤§çš„å‘å¸ƒå·¥å…·
- **çŸ­é“¾æ¥æ”¯æŒ**: æ”¯æŒè§£æ Suno åˆ†äº«çŸ­é“¾æ¥ (`suno.com/s/...`)ï¼Œè‡ªåŠ¨è¿˜åŸçœŸå®æ­Œæ›²ä¿¡æ¯ã€‚
- **æ™ºèƒ½åˆ†äº«é“¾æ¥**: è‡ªåŠ¨æ¸…æ´—å¼€å‘ç¯å¢ƒäº§ç”Ÿçš„ `blob:` å‰ç¼€ï¼Œç”Ÿæˆæ ‡å‡†ã€å¹²å‡€çš„å…¬å…±åˆ†äº«é“¾æ¥ã€‚
- **æ™ºèƒ½è§£æ**: åªéœ€ç²˜è´´ Suno é“¾æ¥ï¼Œè‡ªåŠ¨æå–å°é¢ã€æ­Œè¯ã€æµæ´¾æ ‡ç­¾å’ŒéŸ³é¢‘æ–‡ä»¶ã€‚
- **æ‰¹é‡å¯¼å…¥**: æ”¯æŒæ–‡æœ¬æ‰¹é‡ç²˜è´´é“¾æ¥ï¼Œè‡ªåŠ¨å»é‡å¤„ç†ã€‚
- **å®˜ç½‘ä¸€é”®æŠ“å–**: æä¾› Tampermonkey è„šæœ¬ï¼Œæ”¯æŒåœ¨ Suno å®˜ç½‘ä¸€é”®å¯¼å‡ºâ€œå–œæ¬¢çš„æ­Œæ›²â€åˆ—è¡¨ï¼ˆå«å°é¢/æ ‡é¢˜ï¼‰ï¼Œå¹¶åœ¨æœ¬ç«™ç§’çº§å¯¼å…¥ã€‚

### â˜ï¸ èµ„æºæŒä¹…åŒ–
- **è‡ªåŠ¨å¤‡ä»½**: å‘å¸ƒæ—¶è‡ªåŠ¨å°† Suno çš„ä¸´æ—¶ CDN é“¾æ¥è½¬å­˜è‡³æ‚¨é…ç½®çš„ Supabase Storageï¼Œé˜²æ­¢é“¾æ¥å¤±æ•ˆã€‚
- **å¤šé‡ä»£ç†**: å†…ç½®å¤šçº§ä»£ç†ç­–ç•¥ (Weserv, AllOrigins)ï¼Œç¡®ä¿éŸ³é¢‘å’Œå›¾ç‰‡èµ„æºçš„ç¨³å®šæŠ“å–ã€‚

### ğŸ‘¥ ç¤¾åŒºä¸äº’åŠ¨
- **å®æ—¶åœ¨çº¿**: æŸ¥çœ‹å½“å‰åŒæ—¶åœ¨çº¿çš„å¬ä¼—äººæ•°ã€‚
- **è¯„åˆ†ä¸è¯„è®º**: å®Œæ•´çš„äº”æ˜Ÿè¯„åˆ†ç³»ç»Ÿå’Œè¯„è®ºåŒºã€‚
- **ç”¨æˆ·æ¡£æ¡ˆ**: æ”¯æŒè‡ªå®šä¹‰æ˜µç§°ã€å¹´é¾„ã€æ€§åˆ«ï¼Œå¹¶æ ¹æ®ç‰¹å¾è‡ªåŠ¨ç”Ÿæˆä¸ªæ€§åŒ–å¤´åƒã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ (æœ¬åœ°å¼€å‘)

### 1. ç¯å¢ƒå‡†å¤‡
ç¡®ä¿æ‚¨çš„ç¯å¢ƒå·²å®‰è£… Node.js (v18+) å’Œ npm/pnpmã€‚

### 2. å®‰è£…ä¾èµ–
```bash
npm install
```

### 3. é…ç½®ç¯å¢ƒå˜é‡
åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„ Supabase é…ç½®ï¼š

```env
VITE_SUPABASE_URL=your_supabase_project_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

### 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```

---

## ğŸ—„ï¸ åç«¯é…ç½® (Supabase)

æœ¬é¡¹ç›®å®Œå…¨åŸºäº Supabase (BaaS) æ„å»ºã€‚è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤åˆå§‹åŒ–æ‚¨çš„åç«¯ã€‚

### 1. Storage é…ç½® (âš ï¸ å¿…é¡»æ‰§è¡Œ)
ä¸ºäº†å®ç°èµ„æºæ°¸ä¹…å­˜å‚¨ï¼Œå¿…é¡»åˆ›å»ºå­˜å‚¨æ¡¶ï¼š
1. è¿›å…¥ **Storage** é¢æ¿ã€‚
2. åˆ›å»ºæ–° Bucketï¼Œå‘½åä¸º `suno-media`ã€‚
3. âš ï¸ **åŠ¡å¿…å°† Public Access è®¾ä¸º True** (å…¬å¼€è®¿é—®)ï¼Œå¦åˆ™æ’­æ”¾å™¨ä¼šæŠ¥ 404/403 é”™è¯¯ã€‚
4. æ·»åŠ  **Policy** (å…è®¸æ‰€æœ‰æ“ä½œ)ï¼š
   - å…è®¸ `SELECT`, `INSERT`, `UPDATE`, `DELETE`ã€‚
   - ç›®æ ‡è§’è‰²ï¼š`Authenticated` (ç™»å½•ç”¨æˆ·)ã€‚

### 2. Database Schema (ä¸€é”®å»ºè¡¨)
åœ¨ Supabase **SQL Editor** ä¸­è¿è¡Œä»¥ä¸‹ SQL è„šæœ¬ä»¥åˆå§‹åŒ–æ•°æ®åº“ç»“æ„ã€‚

**âš ï¸ æ³¨æ„ï¼šè¯·å°†è„šæœ¬åº•éƒ¨çš„ `774frank1@gmail.com` æ›¿æ¢ä¸ºæ‚¨è‡ªå·±çš„ç®¡ç†å‘˜é‚®ç®±ï¼**

```sql
-- ============================================================
-- Tunora Database Schema - å®Œæ•´ç‰ˆ (2025-04-12)
-- åŒ…å«ï¼šæ­Œæ›²åº“ã€è¯„åˆ†ç³»ç»Ÿã€ç”¨æˆ·æ¡£æ¡ˆã€ç®¡ç†å‘˜æƒé™ã€è‡ªåŠ¨åŒæ­¥è§¦å‘å™¨
-- ============================================================

-- 1. åˆ›å»ºæ­Œæ›²è¡¨ (Songs)
create table if not exists public.songs (
  id uuid default gen_random_uuid() primary key,
  suno_id text not null unique,
  title text not null,
  artist text,
  image_url text,
  audio_url text,
  created_at timestamp with time zone default timezone('utc'::text, now())
);

-- è¡¥å…¨ Songs è¡¨å­—æ®µ (ç¡®ä¿æ‰€æœ‰åŠŸèƒ½å­—æ®µå­˜åœ¨)
alter table public.songs add column if not exists category text;
alter table public.songs add column if not exists duration int default 0;
alter table public.songs add column if not exists tags text[];
alter table public.songs add column if not exists plays_count int default 0;
alter table public.songs add column if not exists likes_count int default 0;
alter table public.songs add column if not exists user_id uuid references auth.users(id);
alter table public.songs add column if not exists average_rating float default 0; -- è¯„åˆ†
alter table public.songs add column if not exists total_reviews int default 0;  -- è¯„ä»·æ•°
alter table public.songs add column if not exists lyrics text;                  -- æ­Œè¯

-- 2. åˆ›å»ºè¯„ä»·è¡¨ (Reviews)
create table if not exists public.reviews (
  id uuid default gen_random_uuid() primary key,
  song_id uuid references public.songs(id) on delete cascade,
  user_id uuid references auth.users(id),
  user_email text,
  rating int not null check (rating >= 1 and rating <= 5),
  comment text,
  created_at timestamp with time zone default timezone('utc'::text, now()),
  unique(song_id, user_id) -- é™åˆ¶ï¼šæ¯äººæ¯é¦–æ­Œåªèƒ½è¯„ä¸€æ¬¡
);

-- 3. åˆ›å»ºç”¨æˆ·æ¡£æ¡ˆè¡¨ (Profiles) - ç”¨äºå­˜å‚¨æ˜µç§°ã€æ€§åˆ«ã€å¤´åƒ
create table if not exists public.profiles (
  id uuid references auth.users on delete cascade not null primary key,
  email text,
  nickname text,
  gender text,
  age int,
  avatar_url text,
  created_at timestamp with time zone default timezone('utc'::text, now())
);

-- ============================================================
-- å®‰å…¨ç­–ç•¥é…ç½® (RLS - Row Level Security)
-- ============================================================

-- å¼€å¯æ‰€æœ‰è¡¨çš„ RLS
alter table public.songs enable row level security;
alter table public.reviews enable row level security;
alter table public.profiles enable row level security;

-- æ¸…ç†æ—§ç­–ç•¥ (é˜²æ­¢é‡å¤æŠ¥é”™)
drop policy if exists "Enable read access for all users" on public.songs;
drop policy if exists "Enable insert for all users" on public.songs;
drop policy if exists "Enable update for all users" on public.songs;
drop policy if exists "Allow Public Read" on public.songs;
drop policy if exists "Allow Authenticated Insert" on public.songs;
drop policy if exists "Allow Public Update" on public.songs;
drop policy if exists "Allow Admin or Owner Delete Songs" on public.songs;

drop policy if exists "Allow Public Read Reviews" on public.reviews;
drop policy if exists "Allow Authenticated Insert Reviews" on public.reviews;
drop policy if exists "Allow Admin or Owner Delete Reviews" on public.reviews;

drop policy if exists "Public profiles are viewable by everyone." on public.profiles;
drop policy if exists "Users can insert their own profile." on public.profiles;
drop policy if exists "Users can update their own profile." on public.profiles;

-- === A. æ­Œæ›²è¡¨ç­–ç•¥ (Songs) ===

-- 1. æŸ¥çœ‹: å…è®¸æ‰€æœ‰äºº
create policy "Allow Public Read" 
on public.songs for select 
using (true);

-- 2. å‘å¸ƒ: åªå…è®¸ç™»å½•ç”¨æˆ·
create policy "Allow Authenticated Insert" 
on public.songs for insert 
to authenticated 
with check (auth.uid() = user_id);

-- 3. æ›´æ–°: å…è®¸æ‰€æœ‰äºº (ä¸ºäº†æ›´æ–°æ’­æ”¾é‡/ç‚¹èµæ•°/è¯„åˆ†ï¼Œè¿™é‡Œæ”¾å®½æƒé™)
create policy "Allow Public Update" 
on public.songs for update 
using (true);

-- 4. åˆ é™¤: ğŸ”¥ å…è®¸ [æ­Œæ›²ä¸»äºº] æˆ– [æŒ‡å®šç®¡ç†å‘˜] åˆ é™¤
create policy "Allow Admin or Owner Delete Songs" 
on public.songs for delete 
using (
  auth.uid() = user_id 
  OR 
  (auth.jwt() ->> 'email') = '774frank1@gmail.com' -- ğŸ‘ˆ è¯·æ›¿æ¢ä¸ºæ‚¨è‡ªå·±çš„ç®¡ç†å‘˜é‚®ç®±ï¼ï¼
);

-- === B. è¯„ä»·è¡¨ç­–ç•¥ (Reviews) ===

-- 1. æŸ¥çœ‹: å…è®¸æ‰€æœ‰äºº
create policy "Allow Public Read Reviews" 
on public.reviews for select 
using (true);

-- 2. è¯„è®º: åªå…è®¸ç™»å½•ç”¨æˆ·
create policy "Allow Authenticated Insert Reviews" 
on public.reviews for insert 
to authenticated 
with check (auth.uid() = user_id);

-- 3. åˆ é™¤: ğŸ”¥ å…è®¸ [è¯„è®ºä¸»äºº] æˆ– [æŒ‡å®šç®¡ç†å‘˜] åˆ é™¤
create policy "Allow Admin or Owner Delete Reviews" 
on public.reviews for delete 
using (
  auth.uid() = user_id 
  OR 
  (auth.jwt() ->> 'email') = '774frank1@gmail.com' -- ğŸ‘ˆ è¯·æ›¿æ¢ä¸ºæ‚¨è‡ªå·±çš„ç®¡ç†å‘˜é‚®ç®±ï¼ï¼
);

-- === C. ç”¨æˆ·æ¡£æ¡ˆè¡¨ç­–ç•¥ (Profiles) ===

-- 1. æŸ¥çœ‹: å…è®¸æ‰€æœ‰äºº (ç”¨äºæ˜¾ç¤ºå¤´åƒå’Œæ˜µç§°)
create policy "Public profiles are viewable by everyone." 
on public.profiles for select 
using (true);

-- 2. æ’å…¥: åªå…è®¸ç”¨æˆ·æ’å…¥è‡ªå·±çš„æ¡£æ¡ˆ
create policy "Users can insert their own profile." 
on public.profiles for insert 
with check (auth.uid() = id);

-- 3. æ›´æ–°: åªå…è®¸ç”¨æˆ·æ›´æ–°è‡ªå·±çš„æ¡£æ¡ˆ
create policy "Users can update their own profile." 
on public.profiles for update 
using (auth.uid() = id);

-- ============================================================
-- è‡ªåŠ¨åŒ–è§¦å‘å™¨ (Triggers)
-- ============================================================

-- å‡½æ•°: å¤„ç†æ–°ç”¨æˆ·æ³¨å†Œ
-- ä½œç”¨: å½“ç”¨æˆ·æ³¨å†Œæ—¶ï¼Œè‡ªåŠ¨ä» auth.users çš„ metadata ä¸­æå–æ˜µç§°ã€æ€§åˆ«ç­‰ï¼Œå†™å…¥ public.profiles
create or replace function public.handle_new_user() 
returns trigger as $$
begin
  insert into public.profiles (id, email, nickname, gender, age, avatar_url)
  values (
    new.id, 
    new.email, 
    new.raw_user_meta_data->>'nickname',
    new.raw_user_meta_data->>'gender',
    (new.raw_user_meta_data->>'age')::int,
    new.raw_user_meta_data->>'avatar_url'
  );
  return new;
end;
$$ language plpgsql security definer;

-- ç»‘å®šè§¦å‘å™¨
drop trigger if exists on_auth_user_created on auth.users;
create trigger on_auth_user_created
  after insert on auth.users
  for each row execute procedure public.handle_new_user();

-- âœ… SQL æ‰§è¡Œå®Œæ¯•
```

### 3. Authentication é…ç½®
1. åœ¨ **Authentication -> Providers** ä¸­å¯ç”¨ **Email**ã€‚
2. å»ºè®®å…³é—­ **Confirm email** (ä¸éœ€è¦é‚®ç®±éªŒè¯é“¾æ¥)ï¼Œä»¥è·å¾—ä¸æ»‘çš„æ³¨å†Œä½“éªŒã€‚

---

## ğŸ› ï¸ ç®¡ç†å‘˜è®¾ç½®

é¡¹ç›®å†…ç½®äº†ç®€å•çš„ç®¡ç†å‘˜æƒé™æ§åˆ¶ï¼ˆä¸»è¦æ˜¯åˆ é™¤ä»»æ„æ­Œæ›²å’Œè¯„è®ºï¼‰ã€‚
1. åœ¨ä»£ç ä¸­æœç´¢ `ADMIN_EMAIL` å¸¸é‡ï¼Œå°†å…¶ä¿®æ”¹ä¸ºæ‚¨çš„é‚®ç®±ã€‚
2. ç¡®ä¿æ•°æ®åº“ RLS ç­–ç•¥ä¸­çš„é‚®ç®±ä¹Ÿå·²ä¿®æ”¹ã€‚
3. ä½¿ç”¨è¯¥é‚®ç®±æ³¨å†Œ/ç™»å½•åï¼Œæ‚¨å°†è·å¾—ï¼š
   - å…¨å±€åˆ é™¤æƒé™ã€‚
   - ä¸“å±çš„ç®¡ç†å‘˜å¤´åƒé«˜äº®æ˜¾ç¤ºã€‚

---

## ğŸ¤– è‡ªåŠ¨åŒ–è„šæœ¬ (Tampermonkey)

ä¸ºäº†æ–¹ä¾¿ä» Suno å®˜ç½‘è¿ç§»æ•°æ®ï¼Œæˆ‘ä»¬åœ¨ `src/pages/Publish.tsx` ä¸­å†…ç½®äº†ä¸€ä¸ªæ²¹çŒ´è„šæœ¬ã€‚
1. åœ¨åº”ç”¨çš„â€œå‘å¸ƒ -> Suno å¯¼å…¥â€é¡µé¢å¤åˆ¶è„šæœ¬ã€‚
2. åœ¨æµè§ˆå™¨å®‰è£… Tampermonkey æ’ä»¶å¹¶æ·»åŠ è„šæœ¬ã€‚
3. è®¿é—® Suno å®˜ç½‘ï¼Œç‚¹å‡»å³ä¸Šè§’çš„å¯¼å‡ºæŒ‰é’®å³å¯ã€‚

---

## ğŸ“„ License

MIT
